---
import ThemeToggle from "./ThemeToggle.astro";

interface Props {
  currentPath?: string;
}

const { currentPath = "" } = Astro.props;

const navLinks = [
  { href: "/", label: "Home" },
  { href: "/blog", label: "Blog" },
  { href: "/portfolio", label: "Portfolio" },
  { href: "/about", label: "About" },
  { href: "/contact", label: "Contact" },
  { href: "/legacy", label: "Legacy" },
];

function isActive(href: string): boolean {
  if (href === "/") {
    return currentPath === "/" || currentPath === "";
  }
  return currentPath.startsWith(href);
}
---

<header class="sticky top-0 z-50 border-b border-[var(--border-color)] backdrop-blur-sm bg-white/90 dark:bg-slate-900/90">
  <nav class="container flex items-center justify-between h-16">
    <a href="/" class="flex items-center gap-2 no-underline font-bold text-xl">
      <span class="bg-gradient-to-br from-[var(--color-primary-500)] to-[var(--color-accent-500)] bg-clip-text text-transparent">Aaron Rosas</span>
    </a>

    <button
      class="mobile-menu-btn md:hidden flex items-center justify-center w-10 h-10 bg-transparent border-none text-[var(--text-primary)] cursor-pointer"
      id="mobile-menu-btn"
      aria-label="Toggle menu"
    >
      <svg
        class="menu-icon"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <line x1="4" x2="20" y1="12" y2="12"></line>
        <line x1="4" x2="20" y1="6" y2="6"></line>
        <line x1="4" x2="20" y1="18" y2="18"></line>
      </svg>
      <svg
        class="close-icon hidden"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path d="M18 6 6 18"></path>
        <path d="m6 6 12 12"></path>
      </svg>
    </button>

    <div class="nav-links hidden md:flex items-center gap-8" id="nav-links">
      <ul class="flex items-center gap-2 list-none m-0 p-0">
        {
          navLinks.map((link) => (
            <li>
              <a
                href={link.href}
                class:list={[
                  "block px-4 py-2 rounded-lg font-medium transition-all duration-200 no-underline",
                  isActive(link.href) 
                    ? "text-[var(--color-primary-500)] bg-[var(--bg-tertiary)]" 
                    : "text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]"
                ]}
              >
                {link.label}
              </a>
            </li>
          ))
        }
      </ul>
      <ThemeToggle />
    </div>
  </nav>
</header>

<style>
  .mobile-menu-btn.open .menu-icon {
    display: none;
  }

  .mobile-menu-btn.open .close-icon {
    display: block;
  }

  @media (max-width: 768px) {
    .nav-links {
      position: fixed;
      top: 4rem;
      left: 0;
      right: 0;
      bottom: 0;
      flex-direction: column;
      justify-content: flex-start;
      padding: 2rem;
      background-color: var(--bg-primary);
      gap: 2rem;
      transform: translateX(100%);
      transition: transform 0.3s ease;
    }

    .nav-links.open {
      display: flex;
      transform: translateX(0);
    }

    .nav-links ul {
      flex-direction: column;
      width: 100%;
    }

    .nav-links li {
      width: 100%;
    }

    .nav-links a {
      display: block;
      padding: 1rem;
      text-align: center;
      font-size: 1.125rem;
    }
  }
</style>

<script>
  function initMobileMenu() {
    const menuBtn = document.getElementById("mobile-menu-btn");
    const navLinks = document.getElementById("nav-links");

    if (!menuBtn || !navLinks) return;

    menuBtn.addEventListener("click", () => {
      menuBtn.classList.toggle("open");
      navLinks.classList.toggle("open");
    });

    document.querySelectorAll(".nav-links a").forEach((link) => {
      link.addEventListener("click", () => {
        menuBtn.classList.remove("open");
        navLinks.classList.remove("open");
      });
    });
  }

  initMobileMenu();

  document.addEventListener("astro:after-swap", initMobileMenu);
</script>
